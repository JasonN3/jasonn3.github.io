<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-RH/satellite/kickstart-in-Azure">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Kickstart in Azure | Jason Nagin&#x27;s Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jasonn3.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jasonn3.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jasonn3.github.io/RH/satellite/kickstart-in-Azure"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kickstart in Azure | Jason Nagin&#x27;s Docs"><meta data-rh="true" name="description" content="Using Kickstart in Azure gives you a way to utilize all of your existing on-prem processes in the Cloud. However, you can&#x27;t directly boot an ISO. Instead you need to convert it to a VHD. Here are the steps to convert the bootdisk Satellite creates in to a VHD that you can then use in Azure."><meta data-rh="true" property="og:description" content="Using Kickstart in Azure gives you a way to utilize all of your existing on-prem processes in the Cloud. However, you can&#x27;t directly boot an ISO. Instead you need to convert it to a VHD. Here are the steps to convert the bootdisk Satellite creates in to a VHD that you can then use in Azure."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jasonn3.github.io/RH/satellite/kickstart-in-Azure"><link data-rh="true" rel="alternate" href="https://jasonn3.github.io/RH/satellite/kickstart-in-Azure" hreflang="en"><link data-rh="true" rel="alternate" href="https://jasonn3.github.io/RH/satellite/kickstart-in-Azure" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jason Nagin&#39;s Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jason Nagin&#39;s Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8cffe877.css">
<link rel="preload" href="/assets/js/runtime~main.8e26dbfe.js" as="script">
<link rel="preload" href="/assets/js/main.a913cd9f.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Home" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Home" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><a href="https://github.com/jasonn3/jasonn3.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/red-hat">Red Hat</a><button aria-label="Toggle the collapsible sidebar category &#x27;Red Hat&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/active-directory">Active Directory</a><button aria-label="Toggle the collapsible sidebar category &#x27;Active Directory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/satellite">Satellite</a><button aria-label="Toggle the collapsible sidebar category &#x27;Satellite&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/RH/satellite/config-management">Managing Configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/RH/satellite/hostgroups">Managing Host Groups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/RH/satellite/kickstart-in-Azure">Kickstart in Azure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/RH/satellite/provisioning">Provisioning</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/puppet">Puppet</a><button aria-label="Toggle the collapsible sidebar category &#x27;Puppet&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/RH/satellite/remote-execution">Remote Execution</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/red-hat"><span itemprop="name">Red Hat</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/satellite"><span itemprop="name">Satellite</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kickstart in Azure</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Kickstart in Azure</h1><p>Using Kickstart in Azure gives you a way to utilize all of your existing on-prem processes in the Cloud. However, you can&#x27;t directly boot an ISO. Instead you need to convert it to a VHD. Here are the steps to convert the bootdisk Satellite creates in to a VHD that you can then use in Azure.</p><p>These tasks need to be completed on a Windows machine</p><p>First, get the ISO we need to clone</p><ol><li>Launch a web browse and log in to your Satellite server</li><li>Browse to the subnets section (Infrastructure -&gt; Subnets)</li><li>On the far right of one of your subnets, click the arrow down next to <code>Delete</code> and click <code>Subnet generic image</code><br>This image will contain the PXE information required to deploy any VM. If you use any Capsule servers, make sure you select a subnet that has the same <code>HTTPBoot Capsule</code>. Even though the image is labeled subnet specific, the only information contained is the satellite/capsule server url.  </li></ol><p>Next, download GParted so we can clone the ISO to the &quot;disk&quot;</p><ol><li>Download <a href="https://downloads.sourceforge.net/gparted/gparted-live-1.5.0-1-amd64.iso" target="_blank" rel="noopener noreferrer">GParted</a></li></ol><p>Next, we&#x27;ll create the virtual &quot;disk&quot; that we&#x27;ll later upload to Azure. This cannot be done while creating the VM because that will create a VHDX and Azure needs a VHD</p><ol><li>Launch Disk Management<br>This can be done by clicking start and typing in <code>diskmgmt.msc</code>. As you are typing it, you may see <code>Create and format hard disk partitions</code>. That is just a different name for the same application. Click on that or <code>diskmgmt.msc</code>.</li><li>Select <code>Action</code> on the menu bar and then click <code>Create VHD</code></li><li>Use <code>Browse</code> to select a location to save the VHD</li><li>Enter <code>3MB</code> as the size</li><li>Make sure that <code>VHD</code> is selected. VHDX is not supported in Azure</li><li>Make sure the disk type is <code>Fixed size</code></li><li>Click OK</li><li>Right click on the new disk and click <code>Detach VHD</code>  </li></ol><p>Next, create the VM that will clone the ISO to the &quot;disk&quot;</p><ol><li>Launch Hyper-V. If you don&#x27;t have it installed, please follow <a href="https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v" target="_blank" rel="noopener noreferrer">these instructions</a></li><li>Right click on your machine and click <code>New</code> -&gt; <code>Virtual Machine...</code></li><li>Click <code>Next</code> to get past the <code>Before your Begin</code> page</li><li>Give your VM a name</li><li>Click <code>Next</code></li><li>Leave the Virtual machine set to <code>Generation 1</code></li><li>Click <code>Next</code></li><li>Click <code>Next</code> without changing the memory</li><li>Click <code>Next</code> without setting a connection</li><li>Select <code>Use an existing virtual hard disk</code> and select the VHD we created earlier</li><li>Click <code>Next</code> and then <code>Finish</code>. It may take a little while for the VM to create</li><li>Right click on the new VM you created and select <code>Settings</code></li><li>Select the <code>DVD Drive</code> and then select GParted ISO you downloaded earlier</li><li>Click on <code>IDE Controller 1</code>, select <code>DVD Drive</code>, and then click <code>Add</code> to add a second DVD Drive</li><li>On the new <code>DVD Drive</code>, select the boot disk you downloaded earlier from the Satellite server</li><li>Click <code>OK</code></li><li>Right click on the VM and click <code>Connect</code></li><li>Click <code>Start</code></li><li>Press <code>Enter</code> to boot GParted with the default settings</li><li>Press <code>Enter</code> to select <code>Don&#x27;t touch keymap</code></li><li>Press <code>Enter</code> to select <code>US English</code></li><li>Press <code>2</code> and then <code>Enter</code> to select <code>Enter command line prompt</code></li><li>Run <code>lsblk</code> and verify that you see <code>sda</code> with a size of <code>10M</code> and <code>sr1</code>. <code>sr1</code> is the second DVD drive which is where we mounted boot disk. <code>sda</code> is the first hard drive, which is where the VHD is mounted. If the drives are labeled differently for you, make sure to adjust the command in the next step.</li><li>Run <code>dd if=/dev/sr1 of=/dev/sda status=progress</code> to copy the boot disk to the VHD. The command should complete quickly.</li><li>You can now shut down the VM by clicking <code>Action</code> in the menu bar and then <code>Turn Off...</code></li><li>Once the VM is off you can then upload the VHD to Azure using <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/disks-upload-vhd-to-managed-disk-powershell#use-add-azvhd" target="_blank" rel="noopener noreferrer">Add-AzVHD</a> or <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/disks-upload-vhd-to-managed-disk-powershell#manual-upload" target="_blank" rel="noopener noreferrer">AzCopy</a> or <a href="https://learn.microsoft.com/en-us/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows" target="_blank" rel="noopener noreferrer">Azure Storage Explorer</a></li></ol><p>Now that we have a VHD that can boot to Satellite, lets configure Satellite to know what to do with an unknown machine  </p><p>First, change the default boot option from <code>local</code> to <code>discovery</code></p><p><strong>WARNING</strong> This is a global setting. Any machines that PXE boot from the Satellite server without being registered to Satellite will boot in to discovery. Make sure that PXE is either removed from the boot order or is below the local disk. Machines that Satellite is aware of will exit PXE by default unless build mode is enabled for that host.</p><ol><li>Launch a web browse and log in to your Satellite server</li><li>Go to Settings by hovering over <code>Administer</code> and selecting <code>Settings</code></li><li>Select the <code>Provisioning</code> tab</li><li>Edit the value for <code>Default PXE global template entry</code> and set it to <code>discovery</code></li><li>On the Satellite server, install foreman-discovery-image using <code>satellite-maintain packages install foreman-discovery-image</code></li><li>On the Satellite server, run <code>discovery-iso-to-pxe /usr/share/foreman-discovery-image/foreman-discovery-image-3.8.2-1.iso</code> to convert the discovery ISO to PXE. The version of the ISO may change as new version of Satellite are released. Even though it will create a tftpboot directory in the current directory, it will copy the files you need in to the right location.</li></ol><p>You can now use the uploaded VHD as your source image when creating a new VM. When the VM boots, it will request a DHCP lease, override the options related to PXE, PXE boot from the Satellite server, boot the discover image, and then it will wait for you to provision the host. Provisioning can be done from Hosts -&gt; Discovered Hosts within the Satellite Web UI. Once the host is provisioned, the VM will reboot and start the installation. During the installation, it will format the disk and replace it with the selected OS. You can also automate the provisioning process using <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.13/html/provisioning_hosts/configuring_the_discovery_service_provisioning#Creating_Discovery_Rules_provisioning" target="_blank" rel="noopener noreferrer">Discovery Rules</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/RH/satellite/hostgroups"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Managing Host Groups</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/RH/satellite/provisioning"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Provisioning</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8e26dbfe.js"></script>
<script src="/assets/js/main.a913cd9f.js"></script>
</body>
</html>