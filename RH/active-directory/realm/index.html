<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-RH/active-directory/realm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Why I don&#x27;t use RealmD | Jason Nagin&#x27;s Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://jasonn3.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://jasonn3.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://jasonn3.github.io/RH/active-directory/realm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Why I don&#x27;t use RealmD | Jason Nagin&#x27;s Docs"><meta data-rh="true" name="description" content="RealmD can sometimes be utilized as a shortcut for joining a system to AD. Unfortunately, it skips a few quality of life options and some required options. I&#x27;ve come across a lot of people that have joined their systems to AD and ended up with the machines falling off the domain, dealing with slow logins, or complaining there&#x27;s no way to manage who can log in. Using the method described here, I&#x27;ve had machine stay on the domain for years with no problems, all of the logins were fast, and I could easily manage who could log in and I even could have added SSH keys if I wanted."><meta data-rh="true" property="og:description" content="RealmD can sometimes be utilized as a shortcut for joining a system to AD. Unfortunately, it skips a few quality of life options and some required options. I&#x27;ve come across a lot of people that have joined their systems to AD and ended up with the machines falling off the domain, dealing with slow logins, or complaining there&#x27;s no way to manage who can log in. Using the method described here, I&#x27;ve had machine stay on the domain for years with no problems, all of the logins were fast, and I could easily manage who could log in and I even could have added SSH keys if I wanted."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jasonn3.github.io/RH/active-directory/realm"><link data-rh="true" rel="alternate" href="https://jasonn3.github.io/RH/active-directory/realm" hreflang="en"><link data-rh="true" rel="alternate" href="https://jasonn3.github.io/RH/active-directory/realm" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jason Nagin&#39;s Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jason Nagin&#39;s Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8cffe877.css">
<link rel="preload" href="/assets/js/runtime~main.30e66776.js" as="script">
<link rel="preload" href="/assets/js/main.dfc1bf6e.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Home" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Home" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><a href="https://github.com/jasonn3/jasonn3.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/red-hat">Red Hat</a><button aria-label="Toggle the collapsible sidebar category &#x27;Red Hat&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/active-directory">Active Directory</a><button aria-label="Toggle the collapsible sidebar category &#x27;Active Directory&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/RH/active-directory/join-ad">Joining AD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/RH/active-directory/realm">RealmD</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/satellite">Satellite</a><button aria-label="Toggle the collapsible sidebar category &#x27;Satellite&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/red-hat"><span itemprop="name">Red Hat</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/active-directory"><span itemprop="name">Active Directory</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RealmD</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Why I don&#x27;t use RealmD</h1><p>RealmD can sometimes be utilized as a shortcut for joining a system to AD. Unfortunately, it skips a few quality of life options and some required options. I&#x27;ve come across a lot of people that have joined their systems to AD and ended up with the machines falling off the domain, dealing with slow logins, or complaining there&#x27;s no way to manage who can log in. Using the method described <a href="/RH/active-directory/join-ad">here</a>, I&#x27;ve had machine stay on the domain for years with no problems, all of the logins were fast, and I could easily manage who could log in and I even could have added SSH keys if I wanted.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><table><thead><tr><th>Symptom</th><th>Options</th></tr></thead><tbody><tr><td>Intermittent access denied</td><td><code>ad_enabled_gc = false</code></td></tr><tr><td>Slow logins</td><td><code>ignore_group_members = true</code></td></tr><tr><td>Overlapping UID/GID</td><td><code>ldap_idmap_range_size = 4000000</code></td></tr><tr><td>Home directory with &#x27;@&#x27;</td><td><code>override_homedir = /home/%u</code></td></tr><tr><td>Anyone can login</td><td><code>simple_allow_groups</code></td></tr><tr><td>Domain must be specified</td><td><code>use_fully_qualified_names = false</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-missing-configs-and-how-to-work-around-them">The missing configs and how to work around them<a href="#the-missing-configs-and-how-to-work-around-them" class="hash-link" aria-label="Direct link to The missing configs and how to work around them" title="Direct link to The missing configs and how to work around them">​</a></h2><ol><li><p><code>ad_enable_gc = false</code><br>
<!-- -->This configuration option tells SSSD to ignore global catalogs. This is because when SSSD makes a request to AD, it has the option to look at the global catalog first, which has the potential to speed up or slow down a request. If there are missing fields, a second request should be made to the domain&#x27;s DCs to retreive the remaining fields. However, in my experience, SSSD doesn&#x27;t make that second request. This resulted in users getting intermittently denied access. This is because sometimes SSSD would make a request to a DC on the domain and get the list of groups the user was a member of and sometimes it would make a request to a DC on the parent domain, which didn&#x27;t have the list of groups the user was a member of resulting in SSSD thinking the user wasn&#x27;t a member of any groups.<br>
<!-- -->To work around this missing option, it can be added to the SSSD configuration inside of the <code>[domain/&lt;domain&gt;]</code> section.</p></li><li><p><code>ignore_group_members = true</code>
This configuration option is counter intuitive. At first glance, it sounds like it is saying to ignore the groups the user is a member of, but actually, it is saying don&#x27;t get all of the users in the groups. When user A logs in, you don&#x27;t need to know that users B, C, and D are all members of the same groups as user A. You just need to know what groups user A are in. Not setting this option is typically one of the major reasons for a slow login.<br>
<!-- -->To work around this missing option, it can be added to the SSSD configuration inside of the <code>[domain/&lt;domain&gt;]</code> section.</p></li><li><p><code>ldap_idmap_range_size = 4000000</code>
This configuration option increases the range that SSSD can use. It is required for large environments, but it doesn&#x27;t hurt anything for small environments. When a new user logs in, SSSD will hash the Security Identifiers (SIDs) of the user and groups to generate the UID and GIDs. As long as the range is large enough, it&#x27;s unlikely to get a duplicate. If a duplicate is found, the next available id is used.<br>
<!-- -->To work around this missing option, it can be added to the SSSD configuration inside of the <code>[domain/&lt;domain&gt;]</code> section.</p></li><li><p><code>override_homedir = /home/%u</code> or <code>fallback_homedir = /home/%u</code>
Realm will configure the <code>fallback_homedir</code> to <code>/home/%u@%d</code>. This will result in a &#x27;@&#x27; in your home directory and a long home directory name. If you need to be able to identify domain home directories from local home directories, you can set the value to <code>/home/%d/%u</code>. It will be a longer path, but it won&#x27;t include special characters.
To work around this missing option, it can be added to the SSSD configuration inside of the <code>[domain/&lt;domain&gt;]</code> section.</p></li><li><p><code>simple_allow_groups</code>
This is something that can be configured through <code>realm</code> but I still felt it deserved to be mentioned since it isn&#x27;t enabled by default. When <code>realm</code> joins a machine to the domain, any user in that domain can log in to the system. This includes your janitor if they have an AD account. Even if that AD account was just so they could look at their paychecks. When you run <code>realm --help</code> it only shows that you can permit users to log in. However, if you run <code>realm permit --help</code> it will show you more options including how to allow groups to log in. Regardless of which method you use to join your server to the domain, make sure to restrict who can log in.</p></li><li><p><code>use_fully_qualified_names = false</code>
This is not an option I normally explicitly set in my configurations, but it is the default value. However, when <code>realm</code> join a system, it will set the option to <code>True</code>. When it is true, it will require you to always specify the domain when referencing a domain account. This can cause issues when software is not expecting an &#x27;@&#x27; in the middle of your username.
To work around this option, it can be removed or modified in the SSSD configuration inside of the <code>[domain/&lt;domain&gt;]</code> section.</p></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/RH/active-directory/join-ad"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Joining AD</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/category/satellite"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Satellite</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#the-missing-configs-and-how-to-work-around-them" class="table-of-contents__link toc-highlight">The missing configs and how to work around them</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.30e66776.js"></script>
<script src="/assets/js/main.dfc1bf6e.js"></script>
</body>
</html>